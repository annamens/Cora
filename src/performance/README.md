# Cora Performance Tests

## Introduction

Cora Api performance tests consist of a number of JMeter tests that can be run against a Cora test environment to
generate key performance metrics on api response times, error frequency and latency.  Using the stress test
suite you can simulate many concurrent users of the api making api calls to Cora.  This was built as a simple
proof of concept to see if we can use JMeter for doing performance tests in more detail going forward.


## Prerequisites

- JMeter installed.  
  On a Mac, you can install JMeter using homebrew with this command:
```shell
  brew install JMeter
```

On Windows, you can install JMeter by going to the JMeter website and downloading the latest binaries at
[https://jmeter.apache.org/download_jmeter.cgi](https://jmeter.apache.org/download_jmeter.cgi).  Download the latest
zip, and unzip to a desired location and run it.

## Running the Stress Tests

1. Open JMeter.
2. Within JMeter open the file, CoraStressTests.jmx.
3. Set the host, port, apiUsername and apiPassword in the User Defined Variables section.
4. If this is not the first time running, always click Clear All button to clear the previous results.
5. Click Run.
6. Wait for the tests to complete
7. Switch Aggregate Graph to view api performance metrics

## Thread Groups

JMeter works by configuring a set of thread groups that can be configured to change the degree of concurrency, and
how many times each user executes a set of tests.  There are 3 settings that can be configured:

- Number of threads (users) - number of concurrent users executing the tests in the thread group.
- Ramp-up period (seconds) - time to pause between kicking of a new user thread
- Loop count - number of times each user thread should execute the set of tests in the thread group.

## Samplers

Each tests is called a Sampler, which consists of a request api and request parameters.  It is executed in order for
each user thread generated by the parent thread group.  Each time the sampler is called, is known as a sample.
  
## View Results Tree

Each sample triggered by a sampler is logged to the results tree if that stage is enabled.  It should remain disabled
unless you want to debug something about the api response, as it generates a tonne of logs.  Also each time you run the
test suite, results are appended to the tree, unless you clear the previous results.  

## Aggregate Graph

The Aggregate Graph is a report on the performance of all the tests ran.  It aggregates across tests runs unlesss you 
clear previous results.  It contains response time percentiles and error frequency of each sample.

## More on JMeter

For more detailed information and tutorials on JMeter, see these links:

- [https://jmeter.apache.org/index.html](https://jmeter.apache.org/index.html)
- [https://artoftesting.com/jmeter-tutorial](https://artoftesting.com/jmeter-tutorial)